<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Introduction to R</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h1>Introduction to R</h1>

<ul>
<li>Start RStudio</li>
<li>Under the <code>File</code> menu, click on <code>New project</code>, choose <code>New directory</code>, then
<code>Empty project</code></li>
<li>Enter a name for this new folder, and choose a convenient location for
it. This will be your <strong>working directory</strong> for the rest of the day
(e.g., <code>~/field2db</code>)</li>
<li>Click on &ldquo;Create project&rdquo;</li>
<li>Under the <code>Files</code> tab on the right of the screen, click on <code>New Folder</code> and
create a folder named <code>data</code> within your newly created working directory.
(e.g., <code>~/field2db/data</code>)</li>
<li>Create a new R script (File &gt; New File &gt; R script) and save it in your working
directory (e.g. <code>intro-R.R</code>)</li>
</ul>

<h2>Good practices</h2>

<p>There are two main ways of interacting with R: using the console or by using
script files (plain text files that contain your code).</p>

<p>The recommended approach when working on a data analysis project is dubbed &ldquo;the
source code is real&rdquo;. The objects you are creating should be seen as disposable
as they are the direct realization of your code. Every object in your analysis
can be recreated from your code, and all steps are documented. Therefore, it is
best to enter as little commands as possible in the R console. Instead, all code
should be written in script files, and evaluated from there. The R console
should be used to inspect objects, test a function or get help. With this
approach, the <code>.Rhistory</code> file automatically created during your session should
not be very useful.</p>

<p>You may want your RStudio settings (Tools &gt; Global options) so that the
following three settings are unchecked:</p>

<ul>
<li>&ldquo;Restore most recently opened project at startup&rdquo;</li>
<li>&ldquo;Restore previously open source document at startup&rdquo; (less important)</li>
<li>&ldquo;Restore .RData into workspace at startup&rdquo;</li>
</ul>

<p>and Select &ldquo;Never&rdquo; for &ldquo;Save workspace to .RData on exit&rdquo;.</p>

<p>Similarly, you should separate the original data (raw data) from intermediate
datasets that you may create for the need of a particular analysis. For
instance, you may want to create a <code>data/</code> directory within your working
directory that stores the raw data, and have a <code>data_output/</code> directory for
intermediate datasets and a <code>figure_output/</code> directory for the plots you will
generate.</p>

<p>You can choose your own names for these folders, but it&#39;s important that you
document their purpose (and their content) in a README file, and that you are
coherent in their usage.</p>

<h2>Creating objects</h2>

<p>Let&#39;s start by creating a simple object:</p>

<pre><code class="r">x &lt;- 10
x
</code></pre>

<pre><code>## [1] 10
</code></pre>

<p>We assigned to <code>x</code> the number 10. <code>&lt;-</code> is the assignment operator. It assigns
values on the right to objects on the left. Mostly similar to <code>=</code> but not
always. Learn to use <code>&lt;-</code> as it is good programming practice. Using <code>=</code> in place
of <code>&lt;-</code> can lead to issues down the line. In RStudio, use the key combination
<code>Alt + -</code> to generate the assignment operator.</p>

<p><code>=</code> should only be used to specify the values of arguments in functions for
instance <code>read.csv(file=&quot;data/some_data.csv&quot;)</code>.</p>

<p>Now that <code>x</code> exists in R memory, We can do things with it. For instance:</p>

<pre><code class="r">x * 2
</code></pre>

<pre><code>## [1] 20
</code></pre>

<pre><code class="r">x + 5
</code></pre>

<pre><code>## [1] 15
</code></pre>

<pre><code class="r">x + x
</code></pre>

<pre><code>## [1] 20
</code></pre>

<p>or we can create new objects using <code>x</code>:</p>

<pre><code class="r">y &lt;- x + x + 5
</code></pre>

<p>Let&#39;s try something different:</p>

<pre><code class="r">x &lt;- c(2, 4, 6)
x
</code></pre>

<pre><code>## [1] 2 4 6
</code></pre>

<p>Two things:</p>

<ul>
<li>we overwrote the content of <code>x</code></li>
<li><code>x</code> now contains 3 elements</li>
</ul>

<p>Using the <code>[]</code>, we can access individual elements of this object:</p>

<pre><code class="r">x[1]
</code></pre>

<pre><code>## [1] 2
</code></pre>

<pre><code class="r">x[2]
</code></pre>

<pre><code>## [1] 4
</code></pre>

<pre><code class="r">x[3]
</code></pre>

<pre><code>## [1] 6
</code></pre>

<hr/>

<h3>Challenge</h3>

<p>What is the content of this vector?</p>

<pre><code class="r">q &lt;- c(x, x, 5)
</code></pre>

<p>What is the value of <code>y</code> at the end of this script?</p>

<pre><code class="r">x &lt;- 1
y &lt;- x + 2
x &lt;- 3
# y &lt;- ???
</code></pre>

<hr/>

<p>We can also use these objects with functions, for instance to compute the mean
and the standard deviation:</p>

<pre><code class="r">x &lt;- c(1, 3, 5, 6, 3, 5)
mean(x)
</code></pre>

<pre><code>## [1] 3.833333
</code></pre>

<pre><code class="r">sd(x)
</code></pre>

<pre><code>## [1] 1.834848
</code></pre>

<p>This is useful to print the value of the mean or the standard deviation, but we
can also save these values in their own variables:</p>

<pre><code class="r">mean_x &lt;- mean(x)
mean_x
</code></pre>

<p>The function <code>ls()</code> returns the objects that are currently in the memory of
your session.</p>

<p>The function <code>data()</code> allows you to load into memory datasets that are provided
as examples with R (or some packages). Let&#39;s load the <code>Nile</code> dataset that
provides the annual flow of the river Nile between 1871 and 1970.</p>

<pre><code class="r">data(Nile)
</code></pre>

<p>Using <code>ls()</code> shows you that the function <code>data()</code> made the variable <code>Nile</code>
available to you.</p>

<p>Let&#39;s make an histogram of the values of the flows:</p>

<pre><code class="r">hist(Nile)
</code></pre>

<hr/>

<h3>Challenge</h3>

<p>The following: <code>abline(v=100, col=&quot;red&quot;)</code> would draw a vertical line on an
existing plot at the value 100 colored in red.</p>

<p>How would you add such a line to our histogram to show where the mean falls in
this distribution?</p>

<hr/>

<p>We can now save this plot in its own file:</p>

<pre><code class="r">pdf(file=&quot;nile_flow.pdf&quot;)
hist(Nile)
abline(v=mean(Nile), col=&quot;red&quot;)
dev.off()
</code></pre>

<hr/>

<h2>Vectors</h2>

<p>Vectors are at the heart of how data are stored into R&#39;s memory. Almost
everything in R is stored as a vector. When we typed <code>x &lt;- 10</code> we created a
vector of length 1. When we typed <code>x &lt;- c(2, 4, 6)</code> we created a vector of
length 3. These vectors are of class <code>numeric</code>. Vectors can be of 6 different
classes (we&#39;ll mostly work with 4).</p>

<h3>The different &ldquo;classes&rdquo; of vector</h3>

<p>Vectors can hold numbers, characters, logical values and a special class that
characterizes R, factors.</p>

<ul>
<li><code>&quot;numeric&quot;</code> is the general class for vectors that hold numbers (e.g., <code>c(1, 5,
10)</code>)</li>
<li><code>&quot;integer&quot;</code> is the class for vectors for integers. To differentiate them from
<code>numeric</code> we must add an <code>L</code> afterwards (e.g., <code>c(1L, 2L, 5L)</code>)</li>
<li><code>&quot;character&quot;</code> is the general class for vectors that hold text strings (e.g.,
<code>c(&quot;blue&quot;, &quot;red&quot;, &quot;black&quot;)</code>)</li>
<li><code>&quot;logical&quot;</code> for holding <code>TRUE</code> and <code>FALSE</code> (boolean data type)</li>
</ul>

<p>The other types of vectors are <code>&quot;complex&quot;</code> (for complex numbers) and <code>&quot;raw&quot;</code> a
special internal type that is not of use for the majority of users.</p>

<h3>Naming the elements of a vector</h3>

<pre><code class="r">fav_colors &lt;- c(&quot;red&quot;, &quot;blue&quot;, &quot;green&quot;, &quot;yellow&quot;)
names(fav_colors)
names(fav_colors) &lt;- c(&quot;John&quot;, &quot;Lucy&quot;, &quot;Greg&quot;, &quot;Sarah&quot;)
fav_colors
names(fav_colors)
unname(fav_colors)
</code></pre>

<h3>How to access elements of a vector?</h3>

<p>They can be accessed by their indices:</p>

<pre><code class="r">fav_colors[2]
fav_colors[2:4]
</code></pre>

<p>repeatitions are allowed:</p>

<pre><code class="r">fav_colors[c(2,3,2,4,1,2)]
</code></pre>

<p>or if the vector is named, it can be accessed by the names of the elements:</p>

<pre><code class="r">fav_colors[c(&quot;John&quot;)]
</code></pre>

<hr/>

<h3>Challenges</h3>

<ul>
<li>How to access the content of the vector for &ldquo;Lucy&rdquo;, &ldquo;Sarah&rdquo; and &ldquo;John&rdquo; (in this
order)?</li>
<li>How to get the name of the second person?</li>
</ul>

<hr/>

<h3>How to update/replace the value of a vector?</h3>

<pre><code class="r">x[4] &lt;- 22
</code></pre>

<pre><code class="r">fav_colors[&quot;Sarah&quot;] &lt;- &quot;turquoise&quot;
</code></pre>

<h3>How to add elements to a vector?</h3>

<pre><code class="r">x &lt;- c(5, 10, 15, 20)
x &lt;- c(x, 25) # adding at the end
x &lt;- c(0, x)  # adding at the beginning
x
</code></pre>

<p>With named vectors:</p>

<pre><code class="r">fav_colors
c(fav_colors, &quot;purple&quot;)
fav_colors &lt;- c(fav_colors, &quot;Tracy&quot; = &quot;purple&quot;)
</code></pre>

<p>Notes:</p>

<ul>
<li>here is the case where using the <code>=</code> is OK/needed</li>
<li>pay attention to where the quotes are</li>
</ul>

<hr/>

<h3>Challenge</h3>

<ul>
<li>If we add another element to our vector:</li>
</ul>

<pre><code class="r">fav_color &lt;- c(fav_colors, &quot;black&quot;)
</code></pre>

<p>how to use the function <code>names()</code> to assign the name &ldquo;Ana&rdquo; to this last element?</p>

<hr/>

<h3>How to remove elements from a vector?</h3>

<pre><code class="r">x[-5]
x[-c(1, 3, 5)]
</code></pre>

<p>but this <code>fav_colors[-c(&quot;Tracy&quot;)]</code> does not work. We need to use the function
<code>match()</code>:</p>

<pre><code class="r">fav_colors[-match(&quot;Tracy&quot;, names(fav_colors))]
</code></pre>

<p>The function <code>match()</code> looks for the position of the <strong>first exact match</strong>
within another vector.</p>

<h3>Sequences</h3>

<p><code>:</code> is a special function that creates numeric vectors of integer in increasing
or decreasing order, test <code>1:10</code> and <code>10:1</code> for instance. The function <code>seq()</code>
(for <strong>seq</strong>uence) can be used to create more complex patterns:</p>

<pre><code class="r">seq(1, 10, by=2)
</code></pre>

<pre><code>## [1] 1 3 5 7 9
</code></pre>

<pre><code class="r">seq(5, 10, length.out=3)
</code></pre>

<pre><code>## [1]  5.0  7.5 10.0
</code></pre>

<pre><code class="r">seq(50, by=5, length.out=10)
</code></pre>

<pre><code>##  [1] 50 55 60 65 70 75 80 85 90 95
</code></pre>

<pre><code class="r">seq(1, 8, by=3) # sequence stops to stay below upper limit
</code></pre>

<pre><code>## [1] 1 4 7
</code></pre>

<pre><code class="r">seq(1.1, 2, length.out=10)
</code></pre>

<pre><code>##  [1] 1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9 2.0
</code></pre>

<h3>Repeating</h3>

<pre><code class="r">x &lt;- rep(8, 4)
x
rep(1:3, 3)
</code></pre>

<h3>Operations on vectors</h3>

<pre><code class="r">x &lt;- c(5, 10, 15)
x + 10
x + c(10, 15, 20)
x * 10
x * c(2, 4, 3)
</code></pre>

<p>Note that operations on vectors are elementwise.</p>

<h3>Recycling</h3>

<p>R allows you to do operations on vectors of different lengths. The shorter
vector will be &ldquo;recycled&rdquo; (~ repeated) to match the length of the longer one:</p>

<pre><code class="r">x &lt;- c(5, 10, 15)
x + c(2, 4, 6, 8, 10, 12)     # no warning when it&#39;s a multiple
x + c(2, 4, 6, 8, 10, 12, 14) # warning
</code></pre>

<h3>Boolean operations and Filtering</h3>

<pre><code class="r">u &lt;- c(1, 4, 2, 5, 6, 3, 7)
u[TRUE, FALSE, TRUE, TRUE, TRUE, FALSE, FALSE]
u &lt; 3
u[u &lt; 3]
u[u &lt; 3 | u &gt;= 4]
u[u &gt; 5 &amp; u &lt; 1 ] ## nothing matches this condition
u[u &gt; 5 &amp; u &lt; 8]
</code></pre>

<p>With character strings:</p>

<pre><code class="r">fav_colors &lt;- c(&quot;John&quot; = &quot;red&quot;, &quot;Lucy&quot; = &quot;blue&quot;, &quot;Greg&quot; = &quot;green&quot;,
                &quot;Sarah&quot; = &quot;yellow&quot;, &quot;Tracy&quot; = &quot;purple&quot;)
fav_colors == &quot;blue&quot;
fav_colors[fav_colors == &quot;blue&quot;]
which(fav_colors == &quot;blue&quot;)
names(fav_colors)[which(fav_colors == &quot;blue&quot;)]
</code></pre>

<h2>Presentation of the Survey Data</h2>

<p>We are studying the species and weight of animals caught in plots in our study
area.  The dataset is stored as a <code>.csv</code> file: each row holds information for a
single animal, and the columns represent <code>survey_id</code> , <code>month</code>, <code>day</code>, <code>year</code>,
<code>plot</code>, <code>species</code> (a 2 letter code, see the <code>species.csv</code> file for
correspondance), <code>sex</code> (&ldquo;M&rdquo; for males and &ldquo;F&rdquo; for females), <code>wgt</code> (the weight in
grams).</p>

<p>The first few rows of the survey dataset look like this:</p>

<pre><code>&quot;63&quot;,&quot;8&quot;,&quot;19&quot;,&quot;1977&quot;,&quot;3&quot;,&quot;DM&quot;,&quot;M&quot;,&quot;40&quot;
&quot;64&quot;,&quot;8&quot;,&quot;19&quot;,&quot;1977&quot;,&quot;7&quot;,&quot;DM&quot;,&quot;M&quot;,&quot;48&quot;
&quot;65&quot;,&quot;8&quot;,&quot;19&quot;,&quot;1977&quot;,&quot;4&quot;,&quot;DM&quot;,&quot;F&quot;,&quot;29&quot;
&quot;66&quot;,&quot;8&quot;,&quot;19&quot;,&quot;1977&quot;,&quot;4&quot;,&quot;DM&quot;,&quot;F&quot;,&quot;46&quot;
&quot;67&quot;,&quot;8&quot;,&quot;19&quot;,&quot;1977&quot;,&quot;7&quot;,&quot;DM&quot;,&quot;M&quot;,&quot;36&quot;
</code></pre>

<p>To load our survey data, we need to locate the <code>surveys.csv</code> file. We will use
<code>read.csv()</code> to load into memory (as a <code>data.frame</code>) the content of the CSV
file.</p>

<pre><code class="r">download.file(&quot;http://files.figshare.com/1919744/surveys.csv&quot;, &quot;data/surveys.csv&quot;)
download.file(&quot;http://files.figshare.com/1919741/species.csv&quot;, &quot;data/species.csv&quot;)
surveys &lt;- read.csv(&#39;data/surveys.csv&#39;)
</code></pre>

<!--- this chunk if for internal use so code in this lesson can be evaluated --->

<p>This statement doesn&#39;t produce any output because assignment doesn&#39;t display
anything. If we want to check that our data has been loaded, we can print the
variable&#39;s value: <code>surveys</code></p>

<p>Wow&hellip; that was a lot of output. At least it means the data loaded
properly. Let&#39;s check the top (the first 6 lines) of this <code>data.frame</code> using the
function <code>head()</code>:</p>

<pre><code class="r">head(surveys)
</code></pre>

<pre><code>##   record_id month day year plot_id species_id sex hindfoot_length weight
## 1         1     7  16 1977       2         NL   M              32     NA
## 2         2     7  16 1977       3         NL   M              33     NA
## 3         3     7  16 1977       2         DM   F              37     NA
## 4         4     7  16 1977       7         DM   M              36     NA
## 5         5     7  16 1977       3         DM   M              35     NA
## 6         6     7  16 1977       1         PF   M              14     NA
</code></pre>

<p>Let&#39;s now check the <strong>str</strong>ucture of this <code>data.frame</code> in more details with the
function <code>str()</code>:</p>

<pre><code class="r">str(surveys)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    35549 obs. of  9 variables:
##  $ record_id      : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ month          : int  7 7 7 7 7 7 7 7 7 7 ...
##  $ day            : int  16 16 16 16 16 16 16 16 16 16 ...
##  $ year           : int  1977 1977 1977 1977 1977 1977 1977 1977 1977 1977 ...
##  $ plot_id        : int  2 3 2 7 3 1 2 1 1 6 ...
##  $ species_id     : Factor w/ 49 levels &quot;&quot;,&quot;AB&quot;,&quot;AH&quot;,&quot;AS&quot;,..: 17 17 13 13 13 24 23 13 13 24 ...
##  $ sex            : Factor w/ 6 levels &quot;&quot;,&quot;F&quot;,&quot;M&quot;,&quot;P&quot;,..: 3 3 2 3 3 3 2 3 2 2 ...
##  $ hindfoot_length: int  32 33 37 36 35 14 NA 37 34 20 ...
##  $ weight         : int  NA NA NA NA NA NA NA NA NA NA ...
</code></pre>

<p><strong>Also, show how to get this information from the &ldquo;Environment&rdquo; tab in RStudio.</strong></p>

<h3>Challenge</h3>

<p>Based on the output of <code>str(surveys)</code>, can you answer the following questions?</p>

<ul>
<li>What is the class of the object <code>surveys</code>?</li>
<li>How many rows and how many columns are in this object?</li>
<li>How many species have been recorded during these surveys?</li>
</ul>

<p>As you can see, the columns <code>species</code> and <code>sex</code> are of a special class called
<code>factor</code>. Before we learn more about the <code>data.frame</code> class, we are going to
talk about factors. They are very useful but not necessarily intuitive, and
therefore require some attention.</p>

<h2>Factors</h2>

<p>Factors are used to represent categorical data. Factors can be ordered or
unordered and are an important class for statistical analysis and for plotting.</p>

<p>Factors are stored as integers, and have labels associated with these unique
integers. While factors look (and often behave) like character vectors, they are
actually integers under the hood, and you need to be careful when treating them
like strings.</p>

<p>Once created, factors can only contain a pre-defined set values, known as
<em>levels</em>. By default, R always sorts <em>levels</em> in alphabetical order. For
instance, if you have a factor with 2 levels:</p>

<pre><code class="r">sex &lt;- factor(c(&quot;male&quot;, &quot;female&quot;, &quot;female&quot;, &quot;male&quot;))
</code></pre>

<p>R will assign <code>1</code> to the level <code>&quot;female&quot;</code> and <code>2</code> to the level <code>&quot;male&quot;</code> (because
<code>f</code> comes before <code>m</code>, even though the first element in this vector is
<code>&quot;male&quot;</code>). You can check this by using the function <code>levels()</code>, and check the
number of levels using <code>nlevels()</code>:</p>

<pre><code class="r">levels(sex)
</code></pre>

<pre><code>## [1] &quot;female&quot; &quot;male&quot;
</code></pre>

<pre><code class="r">nlevels(sex)
</code></pre>

<pre><code>## [1] 2
</code></pre>

<p>Sometimes, the order of the factors does not matter, other times you might want
to specify the order because it is meaningful (e.g., &ldquo;low&rdquo;, &ldquo;medium&rdquo;, &ldquo;high&rdquo;) or
it is required by particular type of analysis. Additionally, specifying the
order of the levels allows to compare levels:</p>

<pre><code class="r">food &lt;- factor(c(&quot;low&quot;, &quot;high&quot;, &quot;medium&quot;, &quot;high&quot;, &quot;low&quot;, &quot;medium&quot;, &quot;high&quot;))
levels(food)
</code></pre>

<pre><code>## [1] &quot;high&quot;   &quot;low&quot;    &quot;medium&quot;
</code></pre>

<pre><code class="r">food &lt;- factor(food, levels=c(&quot;low&quot;, &quot;medium&quot;, &quot;high&quot;))
levels(food)
</code></pre>

<pre><code>## [1] &quot;low&quot;    &quot;medium&quot; &quot;high&quot;
</code></pre>

<pre><code class="r">min(food) ## doesn&#39;t work
</code></pre>

<pre><code>## Error in Summary.factor(structure(c(1L, 3L, 2L, 3L, 1L, 2L, 3L), .Label = c(&quot;low&quot;, : &#39;min&#39; not meaningful for factors
</code></pre>

<pre><code class="r">food &lt;- factor(food, levels=c(&quot;low&quot;, &quot;medium&quot;, &quot;high&quot;), ordered=TRUE)
levels(food)
</code></pre>

<pre><code>## [1] &quot;low&quot;    &quot;medium&quot; &quot;high&quot;
</code></pre>

<pre><code class="r">min(food) ## works!
</code></pre>

<pre><code>## [1] low
## Levels: low &lt; medium &lt; high
</code></pre>

<p>In R&#39;s memory, these factors are represented by numbers (1, 2, 3). They are
better than using simple integer labels because factors are self describing:
<code>&quot;low&quot;</code>, <code>&quot;medium&quot;</code>, and <code>&quot;high&quot;</code>&ldquo; is more descriptive than <code>1</code>, <code>2</code>, <code>3</code>. Which
is low?  You wouldn&#39;t be able to tell with just integer data. Factors have this
information built in. It is particularly helpful when there are many levels
(like the species in our example data set).</p>

<h3>Converting factors</h3>

<p>If you need to convert a factor to a character vector, simply use
<code>as.character(x)</code>.</p>

<p>Converting a factor to a numeric vector is however a little trickier, and you
have to go via a character vector. Compare:</p>

<pre><code class="r">f &lt;- factor(c(1, 5, 10, 2))
as.numeric(f)               ## wrong! and there is no warning...
</code></pre>

<pre><code>## [1] 1 3 4 2
</code></pre>

<pre><code class="r">as.numeric(as.character(f)) ## works...
</code></pre>

<pre><code>## [1]  1  5 10  2
</code></pre>

<pre><code class="r">as.numeric(levels(f))[f]    ## The recommended way.
</code></pre>

<pre><code>## [1]  1  5 10  2
</code></pre>

<h3>Challenge</h3>

<p>The function <code>table()</code> tabulates observations and can be used to create
bar plots quickly. For instance:</p>

<pre><code class="r">## Question: How can you recreate this plot but by having &quot;control&quot;
## being listed last instead of first?
exprmt &lt;- factor(c(&quot;treat1&quot;, &quot;treat2&quot;, &quot;treat1&quot;, &quot;treat3&quot;, &quot;treat1&quot;, &quot;control&quot;,
                   &quot;treat1&quot;, &quot;treat2&quot;, &quot;treat3&quot;))
table(exprmt)
</code></pre>

<pre><code>## exprmt
## control  treat1  treat2  treat3 
##       1       4       2       2
</code></pre>

<pre><code class="r">barplot(table(exprmt))
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk challenge-factor"/> </p>

<h2>About the <code>data.frame</code> class</h2>

<p><code>data.frame</code> is the <em>de facto</em> data structure for most tabular data and what we
use for statistics and plotting.</p>

<p>A <code>data.frame</code> is a collection of vectors of identical lengths. Each vector
represents a column, and each vector can be of a different class (e.g.,
characters, integers, factors). The <code>str()</code> function is useful to inspect the
data types of the columns.</p>

<p>The most common way you are going to create <code>data.frame</code> objects is when you
will use the functions <code>read.csv()</code> or <code>read.table()</code>, in other words, when
importing spreadsheets from your hard drive (or the web).</p>

<p>You can also create <code>data.frame</code> manually with the function <code>data.frame()</code>. This
function can also take the argument <code>stringsAsFactors</code>. Compare the output of
these examples:</p>

<pre><code class="r">example_data &lt;- data.frame(animal=c(&quot;dog&quot;, &quot;cat&quot;, &quot;sea cucumber&quot;, &quot;sea urchin&quot;),
                           feel=c(&quot;furry&quot;, &quot;furry&quot;, &quot;squishy&quot;, &quot;spiny&quot;),
                           weight=c(45, 8, 1.1, 0.8))
str(example_data)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    4 obs. of  3 variables:
##  $ animal: Factor w/ 4 levels &quot;cat&quot;,&quot;dog&quot;,&quot;sea cucumber&quot;,..: 2 1 3 4
##  $ feel  : Factor w/ 3 levels &quot;furry&quot;,&quot;spiny&quot;,..: 1 1 3 2
##  $ weight: num  45 8 1.1 0.8
</code></pre>

<p>Here you can observe the default behavior of the <code>data.frame</code> function. The
columns <code>animal</code> and <code>feel</code> are of class <code>factor</code>. By default, <code>data.frame</code>
converts (= coerces) columns that contain characters (i.e., text) into a vector
of class <code>factor</code>. Depending on what you want to do with the data, you may want
to keep these columns as <code>character</code>. To do so, <code>read.csv()</code> and <code>read.table()</code>
have an argument called <code>stringsAsFactors</code> which can be set to <code>FALSE</code>:</p>

<pre><code class="r">example_data &lt;- data.frame(animal=c(&quot;dog&quot;, &quot;cat&quot;, &quot;sea cucumber&quot;, &quot;sea urchin&quot;),
                           feel=c(&quot;furry&quot;, &quot;furry&quot;, &quot;squishy&quot;, &quot;spiny&quot;),
                           weight=c(45, 8, 1.1, 0.8), stringsAsFactors=FALSE)
str(example_data)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    4 obs. of  3 variables:
##  $ animal: chr  &quot;dog&quot; &quot;cat&quot; &quot;sea cucumber&quot; &quot;sea urchin&quot;
##  $ feel  : chr  &quot;furry&quot; &quot;furry&quot; &quot;squishy&quot; &quot;spiny&quot;
##  $ weight: num  45 8 1.1 0.8
</code></pre>

<p>If you want to manually change the class of one of the column, you can use the
function <code>as.factor()</code> (below we&#39;ll cover in more detail how to work with
columns):</p>

<pre><code class="r">example_data$feel &lt;- as.factor(example_data$feel)
str(example_data)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    4 obs. of  3 variables:
##  $ animal: chr  &quot;dog&quot; &quot;cat&quot; &quot;sea cucumber&quot; &quot;sea urchin&quot;
##  $ feel  : Factor w/ 3 levels &quot;furry&quot;,&quot;spiny&quot;,..: 1 1 3 2
##  $ weight: num  45 8 1.1 0.8
</code></pre>

<h3>Challenge</h3>

<ol>
<li>There are a few mistakes in this hand crafted <code>data.frame</code>, can you spot and
fix them? Don&#39;t hesitate to experiment!</li>
</ol>

<pre><code class="r">author_book &lt;- data.frame(author_first=c(&quot;Charles&quot;, &quot;Ernst&quot;, &quot;Theodosius&quot;),
                          author_last=c(Darwin, Mayr, Dobzhansky),
                          year=c(1942, 1970))
</code></pre>

<ol>
<li>Can you predict the class for each of the columns in the following example?
Check your guesses using <code>str(country_climate)</code>. Are they what you expected?
Why? why not?</li>
</ol>

<pre><code class="r">country_climate &lt;- data.frame(country=c(&quot;Canada&quot;, &quot;Panama&quot;, &quot;South Africa&quot;, &quot;Australia&quot;),
                              climate=c(&quot;cold&quot;, &quot;hot&quot;, &quot;temperate&quot;, &quot;hot/temperate&quot;),
                              temperature=c(10, 30, 18, &quot;15&quot;),
                              north_hemisphere=c(TRUE, TRUE, FALSE, &quot;FALSE&quot;),
                              has_kangaroo=c(FALSE, FALSE, FALSE, 1))
</code></pre>

<p>Check your guesses using <code>str(country_climate)</code>. Are they what you expected?
   Why? why not?</p>

<p>R coerces (when possible) to the data type that is the least common
   denominator and the easiest to coerce to. You can review the notes from the
   second lecture to review the coercion rules R uses.</p>

<h2>Inspecting <code>data.frame</code> objects</h2>

<p>We already saw how the functions <code>head()</code> and <code>str()</code> can be useful to check the
content and the structure of a <code>data.frame</code>. Here is a non-exhaustive list of
functions to get a sense of the content/structure of the data.</p>

<ul>
<li>Size:

<ul>
<li><code>dim()</code> - returns a vector with the number of rows in the first element, and
the number of columns as the second element (the <strong>dim</strong>ensions of the object)</li>
<li><code>nrow()</code> - returns the number of rows</li>
<li><code>ncol()</code> - returns the number of columns</li>
</ul></li>
<li>Content:

<ul>
<li><code>head()</code> - shows the first 6 rows</li>
<li><code>tail()</code> - shows the last 6 rows</li>
</ul></li>
<li>Names:

<ul>
<li><code>names()</code> - returns the column names (synonym of <code>colnames()</code> for <code>data.frame</code>
objects)</li>
<li><code>rownames()</code> - returns the row names</li>
</ul></li>
<li>Summary:

<ul>
<li><code>str()</code> - structure of the object and information about the class, length and
content of  each column</li>
<li><code>summary()</code> - summary statistics for each column</li>
</ul></li>
</ul>

<p>Note: most of these functions are &quot;generic&rdquo;, they can be used on other types of
objects besides <code>data.frame</code>.</p>

<h3>Challenge</h3>

<p>Use these functions on the <code>surveys</code> data set loaded in R.</p>

<h2>Slicing data</h2>

<p>Our survey data frame has rows and columns (it&#39;s a 2-dimensional object), if we
want to extract some specific data from it (a slice of it), we need to specify
the &ldquo;coordinates&rdquo; we want the data to come from. To do this, we use the square
bracket notation (just like with vectors), except that we need to add a comma to
indicate the rows and columns we want. Row numbers come first, followed by
column numbers. Here are some examples:</p>

<pre><code class="r">surveys[1, 1]   # first element in the first column of the data frame
surveys[1, 6]   # first element in the 6th column
surveys[1:3, 7] # first three elements in the 7th column
surveys[3, ]    # the 3rd element for all columns
surveys[, 8]    # the entire 8th column
head_surveys &lt;- surveys[1:6, ] # surveys[1:6, ] is equivalent to head(surveys)
</code></pre>

<h3>Challenge</h3>

<ol>
<li>The function <code>nrow()</code> on a <code>data.frame</code> returns the number of rows. Use it,
in conjuction with <code>seq()</code> to create a new <code>data.frame</code> called
<code>surveys_by_10</code> that includes every 10th row of the survey data frame
starting at row 10 (10, 20, 30, &hellip;)</li>
</ol>

<h2>Subsetting data</h2>

<p>In particular for larger datasets, it can be tricky to remember the column
number that corresponds to a particular variable (Are species names in column 6
or 8? oh, right&hellip; they are in column 7), and using the column number to extract
the data (i.e., <code>surveys[, 7]</code>) may not be practical. In some cases, in which
column the variable will be can change if the script you are using adds or
removes columns. It&#39;s therefore often better to use column names to refer to a
particular variable, and it makes your code easier to read and your intentions
clearer.</p>

<p>You can do operations on a particular column, by selecting it using the <code>$</code>
sign. In this case, the entire column is a vector. For instance, to extract all
the weights from our datasets, we can use: <code>surveys$wgt</code>. You can use
<code>names(surveys)</code> or <code>colnames(surveys)</code> to remind yourself of the column names.</p>

<p>In some cases, you may way to select more than one column. You can do this using
the square brackets: <code>surveys[, c(&quot;wgt&quot;, &quot;sex&quot;)]</code>.</p>

<p>When analyzing data, though, we often want to look at partial statistics, such
as the maximum value of a variable per species or the average value per plot.</p>

<p>One way to do this is to select the data we want, and create a new temporary
array, using the <code>subset()</code> function. For instance, if we just want to look at
the animals of the species &ldquo;DO&rdquo;:</p>

<pre><code class="r">surveys_DO &lt;- subset(surveys, species == &quot;DO&quot;)
</code></pre>

<h3>Challenge</h3>

<ol>
<li><p>What does the following do (Try to guess without executing it)?
<code>surveys_DO$month[2] &lt;- 8</code></p></li>
<li><p>Use the function <code>subset</code> to create a <code>data.frame</code> that contains all
individuals of the species &ldquo;DM&rdquo; that were collected in 2002. How many
individuals of the species &ldquo;DM&rdquo; were collected in 2002?</p></li>
</ol>

<h2>Adding a column to our dataset</h2>

<p>Sometimes, you may have to add a new column to your dataset that represents a
new variable. You can add columns to a <code>data.frame</code> using the function <code>cbind()</code>
(<strong>c</strong>olumn <strong>bind</strong>). Beware, the additional column must have the same number
of elements as there are rows in the <code>data.frame</code>.</p>

<p>In our survey dataset, the species are represented by a 2-letter code (e.g.,
&ldquo;AB&rdquo;), however, we would like to include the species name. The correspondance
between the 2 letter code and the names are in the file <code>species.csv</code>. In this
file, one column includes the genus and another includes the species. First, we
are going to import this file in memory:</p>

<pre><code class="r">species &lt;- read.csv(&quot;data/species.csv&quot;, stringsAsFactors=FALSE)
</code></pre>

<p>We are then going to use the function <code>match()</code> to create a vector that contains
the genus names for all our observations. The function <code>match()</code> takes at least
2 arguments: the values to be matched (in our case the 2 letter code from the
<code>surveys</code> data frame held in the column <code>species</code>), and the table that contains
the values to be matched against (in our case the 2 letter code in the <code>species</code>
data frame held in the column <code>species_id</code>). The function returns the position
of the matches in the table, and this can be used to retrieve the genus names:</p>

<pre><code class="r">surveys_spid_index &lt;- match(surveys$species_id, species$species_id)
surveys_genera &lt;- species$genus[surveys_spid_index]
</code></pre>

<p>Now that we have our vector of genus names, we can add it as a new column to our
<code>surveys</code> object:</p>

<pre><code class="r">surveys &lt;- cbind(surveys, genus=surveys_genera)
</code></pre>

<h3>Challenge</h3>

<ul>
<li><p>Use the same approach to also include the species names in the <code>surveys</code> data
frame.</p></li>
<li><p>Use the help in R to understand what the function <code>paste()</code> does. Use it to
add a new column called <code>genus_species</code> into the <code>species</code> <code>data.frame</code>.</p></li>
<li><p>Use the help to understand what the function <code>merge()</code> does. Use it to create
a new <code>data.frame</code> that combines the content of <code>surveys</code> and the modified
version of <code>species</code>.</p></li>
<li><p>Use this data set to answer the following:</p>

<ul>
<li>How many birds have been captured?</li>
<li>How many individuals of the genus <em>Dipodomys</em> have been captured?</li>
</ul></li>
</ul>

<h2>Adding rows</h2>

<!--- Even if this is not optimal, using this approach requires to cover less   -->

<!--- material such as logical operations on vectors. Depending on how fast the -->

<!--- group moves, it might be better to show the correct way.                  -->

<p>Let&#39;s create a <code>data.frame</code> that contains the information only for the species
&ldquo;DO&rdquo; and &ldquo;DM&rdquo;. We know how to create the data set for each species with the
function <code>subset()</code>:</p>

<pre><code class="r">surveys_DO &lt;- subset(surveys, species == &quot;DO&quot;)
surveys_DM &lt;- subset(surveys, species == &quot;DM&quot;)
</code></pre>

<p>Similarly to <code>cbind()</code> for columns, there is a function <code>rbind()</code> (<strong>r</strong>ow
<strong>bind</strong>) that puts together two <code>data.frame</code>. With <code>rbind()</code> the number of
columns and their names must be identical between the two objects:</p>

<pre><code class="r">surveys_DO_DM &lt;- rbind(surveys_DO, surveys_DM)
</code></pre>

<h3>Challenge</h3>

<ul>
<li><p>Using a similar approach, construct a new <code>data.frame</code> that only includes data
for the years 2000 and 2001.</p></li>
<li><p>How does it differ from <code>subset(surveys, species == &quot;DO&quot; | species == &quot;DM&quot;)</code>?</p></li>
</ul>

<h2>Removing columns</h2>

<p>Just like you can select columns by their positions in the <code>data.frame</code> or by
their names, you can remove them similarly.</p>

<p>To remove it by column number:</p>

<pre><code class="r">surveys_noDate &lt;- surveys[, -c(3:5)]
colnames(surveys)
</code></pre>

<pre><code>##  [1] &quot;record_id&quot;       &quot;month&quot;           &quot;day&quot;            
##  [4] &quot;year&quot;            &quot;plot_id&quot;         &quot;species_id&quot;     
##  [7] &quot;sex&quot;             &quot;hindfoot_length&quot; &quot;weight&quot;         
## [10] &quot;genus&quot;           &quot;species_name&quot;
</code></pre>

<pre><code class="r">colnames(surveys_noDate)
</code></pre>

<pre><code>## [1] &quot;record_id&quot;       &quot;month&quot;           &quot;species_id&quot;      &quot;sex&quot;            
## [5] &quot;hindfoot_length&quot; &quot;weight&quot;          &quot;genus&quot;           &quot;species_name&quot;
</code></pre>

<p>The easiest way to remove by name is to use the <code>subset()</code> function. This time
we need to specify explicitly the argument <code>select</code> as the default is to subset
on rows (as above). The minus sign indicates the names of the columns to remove
(note that the column names should not be quoted):</p>

<pre><code class="r">surveys_noDate2 &lt;- subset(surveys, select=-c(month, day, year))
colnames(surveys_noDate2)
</code></pre>

<pre><code>## [1] &quot;record_id&quot;       &quot;plot_id&quot;         &quot;species_id&quot;      &quot;sex&quot;            
## [5] &quot;hindfoot_length&quot; &quot;weight&quot;          &quot;genus&quot;           &quot;species_name&quot;
</code></pre>

</body>

</html>
